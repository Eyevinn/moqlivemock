# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Changed

- Include SEI NAL units in AVC output
- Renamed asset files to include codec suffix (`video_*_avc.mp4`, `audio_*_aac.mp4`)
- Renamed `utils/videogen` to `utils/contentgen`
- Audio generation moved to shell scripts (`gen_audio_monotonic.sh`, `gen_audio_scale.sh`)
- Improved audio levels for monotonic and scale content (0.5s beeps with fadeout)
- Default track selection in mlmsub now prefers AVC video and AAC audio (lowest bitrate)

### Added

- HEVC support including converted test content
- Time-aligned subtitle tracks in `stpp` and `wvtt` format
  - Listed in catalog and generated by `mlmpub`
  - Can be parsed and written to file by `mlmsub`
- `-catalogout` option in mlmsub to write received catalog JSON to file
  - Supports appending multiple catalog updates to the same file
- Opus audio codec support (CMAF packaging)
  - Bundled Opus test content in `assets/test10s`

### Fixed

- Track selection bug where multiple tracks matching substring caused duplicate init segments

## [0.4.0] - 2026-01-09

### Changed

- Upgraded to MoQ Transport [draft-14][moqt-d14] via [Eyevinn/moqtransport][moqtransport-eyevinn] fork
- Updated handler pattern to use separate `SubscribeHandler` for subscription handling
- Session creation now uses struct initialization with `session.Run(conn)`
- Dependencies now use published Eyevinn fork instead of local path

### Fixed

- RequestID setting in mlmsub (#19)
- MaxRequestID from server in mlmsub

## [0.3.0] - 2025-05-25

### Changed

- Catalog is now based on Github [catalog] of Feb. 28 2025
- Now follows [draft-11 of MoQ Transport][moqt-d11] via [moqtransport][moqtransport] update
- mlmsub now autodetects webtransport from `-addr` argument starting with https://

### Added

- Configuration options for `audiobatch` and `videobatch` to control how many frames should be sent in every MoQ object/CMAF chunk
- systemd service script and helpers for mlmpub
- fingerprint endpoint of mlmpub to be used with WebTransport browser clients like [warp-player[wp]
- Certificate validation and auto-generation for WebTransport-compatible certificates (ECDSA, 14-day validity)

## [0.2.0] - 2025-04-28

### Added

- utils/contentgen to generate test content
- WARP catalog generation and parsing
- wall-clock-synchronized media soursce
- multiplexing received video and audio for direct playback via ffplay
- audio track with monotonic beeps and other track with scale sequence beeps
- track selection based on name substring
- loglevel in mlmsub

### Changed

- configurable qlog destination
- application log to stderr

### Deleted

- The clock namespace and code


## [0.1.0] - 2025-04-15

### Added

- initial version of the repo

[Unreleased]: https://github.com/Eyevinn/moqlivemock/releases/tag/v0.4.0...HEAD
[0.4.0]: https://github.com/Eyevinn/moqlivemock/releases/tag/v0.3.0...v0.4.0
[0.3.0]: https://github.com/Eyevinn/moqlivemock/releases/tag/v0.2.0...v0.3.0
[0.2.0]: https://github.com/Eyevinn/moqlivemock/releases/tag/v0.1.0...v0.2.0
[0.1.0]: https://github.com/Eyevinn/moqlivemock/releases/tag/v0.1.0

[catalog]: https://moq-wg.github.io/warp-streaming-format/draft-ietf-moq-warp.html
[moqt-d11]: https://datatracker.ietf.org/doc/draft-ietf-moq-transport/11/
[moqt-d14]: https://datatracker.ietf.org/doc/draft-ietf-moq-transport/14/
[moqtransport]: https://github.com/mengelbart/moqtransport
[moqtransport-eyevinn]: https://github.com/Eyevinn/moqtransport
[wp]: https://github.com/Eyevinn/warp-player
