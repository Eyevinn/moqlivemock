# Test Media Content for MoQ Live Simulator

This directory contains test video and audio files generated by the `utils/contentgen` tools.
These files are designed specifically for testing MoQ (Media over QUIC) streaming with
each frame packaged individually.

The bitrate and duration is deliberately kept low to make it cheap to bundle the
content with the source code.

The overhead per CMAF sample, i.e. an audio frame or video image is 112bytes
(104bytes moof box + 8bytes mdat header).

For video with 25fps that bitrate is 22kbps.
For audio with 46.875fps that bitrate is 42kbps.

## Files

### Audio Tracks

- `audio_monotonic_128kbps_aac.mp4`: AAC stereo audio track (128 kbps)
  - 48 kHz sample rate, 2 channels (stereo)
  - Contains 880Hz beeps every second (0.5s duration with fadeout)
  - Language code: `mon` (monotonic)

- `audio_monotonic_128kbps_opus.mp4`: Opus stereo audio track (128 kbps)
  - Same content as AAC version, Opus codec

- `audio_monotonic_192kbps_ac3.mp4`: AC-3 (Dolby Digital) stereo audio track (192 kbps)
  - Same content as AAC version, AC-3 codec

- `audio_scale_128kbps_aac.mp4`: AAC stereo audio track (128 kbps)
  - C-major scale notes, one per second (0.5s duration with fadeout)
  - Language code: `sca` (scale)

- `audio_scale_128kbps_opus.mp4`: Opus stereo audio track (128 kbps)
  - Same content as AAC version, Opus codec

- `audio_scale_192kbps_ac3.mp4`: AC-3 (Dolby Digital) stereo audio track (192 kbps)
  - Same content as AAC version, AC-3 codec

### Video Tracks (AVC/H.264)

- `video_400kbps_avc.mp4`: Low bitrate video track (400 kbps)
- `video_600kbps_avc.mp4`: Medium bitrate video track (600 kbps)
- `video_900kbps_avc.mp4`: High bitrate video track (900 kbps)

All video tracks share these properties:
- 1280x720 resolution, 25 fps
- H.264 encoding with only I and P frames (no B-frames)
- IDR (keyframes) every second (25 frames)
- Media timescale: 12800
- 10 seconds duration (250 frames)

### Video Tracks (HEVC/H.265)

- `video_400kbps_hevc.mp4`: Low bitrate HEVC video track (400 kbps)
- `video_600kbps_hevc.mp4`: Medium bitrate HEVC video track (600 kbps)
- `video_900kbps_hevc.mp4`: High bitrate HEVC video track (900 kbps)

Same properties as AVC tracks but with HEVC codec.

## Technical Details

All files are fragmented MP4 files with each frame in an individual fragment, making them
suitable for streaming applications that need to access individual frames. The video files
include overlays showing:

- Current bitrate
- Resolution
- Timestamp
- Frame number

These test files are designed to be used with the MoQ Live Simulator for testing different
aspects of media streaming over QUIC, including adaptive bitrate switching, synchronization,
and performance testing.

## Generation

These files were generated using FFmpeg with specific parameters to ensure compatibility
with the MoQ protocol. For more details on how these files were created, see the
`utils/contentgen` directory in this repository.

## Example Catalog

The file `example_catalog.json` contains an example of a partial MSF/CMSF catalog following
[draft-ietf-moq-msf-00][msf-00] and [draft-ietf-moq-cmsf-00][cmsf-00]. This is for
reference only and does not include the `initData` field (base64-encoded init segments)
required for actual CMAF rendering.

The actual catalog used by `mlmpub` is generated dynamically from the loaded assets and
includes the proper `initData` for each track.

[msf-00]: https://datatracker.ietf.org/doc/html/draft-ietf-moq-msf-00
[cmsf-00]: https://datatracker.ietf.org/doc/html/draft-ietf-moq-cmsf-00
