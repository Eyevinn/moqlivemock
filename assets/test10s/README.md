# Test Media Content for MoQ Live Simulator

This directory contains test video and audio files generated by the `utils/videogen` tool.
These files are designed specifically for testing MoQ (Media over QUIC) streaming with
each frame packaged individually.

The bitrate and duration is deliberately kept low to make it cheap to bundle the
content with the source code.

The overhead per CMAF sample, i.e. an audio frame or video image is 112bytes
(104bytes moof box + 8bytes mdat header).

For video with 25fps that bitrate is 22kbps.
For audio with 46.875fps that bitrate is 42kbps.

## Files

- `audio_128kbps.mp4`: AAC stereo audio track (128 kbps)
  - 48 kHz sample rate
  - 2 channels (stereo)
  - Contains regular beeps every second for easy synchronization testing
  - Media timescale: 48000
  - 10.005333 seconds duration (470 frames, minus 1 for edit list)
  - Average bitrate: 170.73 kbps incl overhead (from file size)


- `video_400kbps.mp4`: Low bitrate video track (400 kbps)
  - 1280×720 resolution
  - 25 frames per second
  - H.264 encoding with only I and P frames (no B-frames)
  - IDR (keyframes) every second (25 frames)
  - Media timescale: 12800
  - 10 seconds duration (250 frames)
  - Average bitrate: 396.30 kbps incl overhead (from file size)

- `video_600kbps.mp4`: Medium bitrate video track (600 kbps)
  - 1280×720 resolution
  - 25 frames per second
  - H.264 encoding with only I and P frames (no B-frames)
  - IDR (keyframes) every second (25 frames)
  - Media timescale: 12800
  - 10 seconds duration (250 frames)
  - Average bitrate: 582.60 kbps incl overhead (from file size)

- `video_900kbps.mp4`: High bitrate video track (900 kbps)
  - 1280×720 resolution
  - 25 frames per second
  - H.264 encoding with only I and P frames (no B-frames)
  - IDR (keyframes) every second (25 frames)
  - Media timescale: 12800
  - 10 seconds duration (250 frames)
  - Average bitrate: 867.60 kbps incl overhead (from file size)

## Technical Details

All files are fragmented MP4 files with each frame in an individual fragment, making them suitable for streaming applications that need to access individual frames. The video files include overlays showing:

- Current bitrate
- Resolution
- Timestamp
- Frame number

These test files are designed to be used with the MoQ Live Simulator for testing different aspects of media streaming over QUIC, including adaptive bitrate switching, synchronization, and performance testing.

## Generation

These files were generated using FFmpeg with specific parameters to ensure compatibility with the MoQ protocol. For more details on how these files were created, see the `utils/videogen` directory in this repository.

## Catalog

The catalog file `catalog.json` contains the same tracks as the generated files,
following the [WARP specification][warp-00], except that the packaging is set to `cmaf`.

To this one can add the init segments as base64 encoded strings, in a field called `initData`
according to the spec.


[warp-00]: https://datatracker.ietf.org/doc/html/draft-ietf-moq-warp-00